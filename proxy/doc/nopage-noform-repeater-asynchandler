{"id":1043063,"slug":"repeater-asynchandler","title":"AsyncHandler","book_id":187346,"book":{"id":187346,"type":"Book","slug":"noform","name":"NoForm","user_id":222786,"description":"NoForm - 让天下没有难做的表单","creator_id":110109,"public":1,"items_count":33,"likes_count":0,"watches_count":4,"content_updated_at":"2019-01-07T03:29:29.431Z","updated_at":"2019-01-07T03:29:29.000Z","created_at":"2018-12-11T00:41:54.000Z","namespace":"nopage/noform","user":{"id":222786,"type":"Group","login":"nopage","name":"NoPage","description":"NoPage - 让天下没有难做的CRUD","avatar_url":"https://gw.alipayobjects.com/zos/rmsportal/SZXCSCJTuhRSmAggBlVp.png","large_avatar_url":"https://gw.alipayobjects.com/zos/rmsportal/SZXCSCJTuhRSmAggBlVp.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://gw.alipayobjects.com/zos/rmsportal/SZXCSCJTuhRSmAggBlVp.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://gw.alipayobjects.com/zos/rmsportal/SZXCSCJTuhRSmAggBlVp.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":5,"public_books_count":4,"followers_count":0,"following_count":0,"created_at":"2018-12-11T00:38:10.000Z","updated_at":"2018-12-11T08:20:27.000Z","_serializer":"v2.user"},"_serializer":"v2.book"},"user_id":110109,"creator":{"id":110109,"type":"User","login":"guishu","name":"鬼鼠","description":null,"avatar_url":"https://cdn.yuque.com/yuque/0/2018/png/110109/1527234002873-avatar/2ccdab19-b7e2-42d6-b097-f42de766f94c.png","large_avatar_url":"https://cdn.yuque.com/yuque/0/2018/png/110109/1527234002873-avatar/2ccdab19-b7e2-42d6-b097-f42de766f94c.png?x-oss-process=image/resize,m_fill,w_320,h_320","medium_avatar_url":"https://cdn.yuque.com/yuque/0/2018/png/110109/1527234002873-avatar/2ccdab19-b7e2-42d6-b097-f42de766f94c.png?x-oss-process=image/resize,m_fill,w_160,h_160","small_avatar_url":"https://cdn.yuque.com/yuque/0/2018/png/110109/1527234002873-avatar/2ccdab19-b7e2-42d6-b097-f42de766f94c.png?x-oss-process=image/resize,m_fill,w_80,h_80","books_count":4,"public_books_count":2,"followers_count":0,"following_count":0,"created_at":"2018-04-24T06:58:34.000Z","updated_at":"2019-01-02T09:12:32.000Z","_serializer":"v2.user"},"format":"asl","body":"","body_draft":"","body_html":"<h1 id=\"lkqimr\" data-type=\"h\"><a class=\"anchor\" id=\"钩子与拦截函数\" href=\"#lkqimr\"></a>钩子与拦截函数</h1><div data-type=\"p\">查看DEMO可以直接看到更详细的配置，请参考<a target=\"_blank\" rel=\"noopener noreferrer nofollow\" href=\"https://alibaba.github.io/noform/examples/build/#/RepeaterAdvanced\" class=\"bi-link\">Repeater 钩子</a></div><div data-type=\"p\"></div><div data-type=\"p\">该配置函数能够控制 Repeter的以下操作： <code>add</code>, <code>update</code>, <code>save</code>, <code>remove</code>通用格式如下：</div><div data-type=\"p\"></div><pre data-syntax=\"jsx\"><code class=\"language-jsx\">const asyncHandler = {\n    add: () =&gt; {},\n    update: () =&gt; {},\n    save: () =&gt; {},\n    remove: () =&gt; {}\n};\n\n&lt;Repeater asyncHandler={asyncHandler}&gt;\n</code></pre><div data-type=\"p\"></div><div data-type=\"p\">asyncHandler 函数可以用 <code>async</code> 或 返回 <code>promise</code></div><div data-type=\"p\"></div><h1 id=\"90aqmf\" data-type=\"h\"><a class=\"anchor\" id=\"-入参\" href=\"#90aqmf\"></a> 入参</h1><div class=\"bi-table\"><table><colgroup><col width=\"auto\"/><col width=\"auto\"/><col width=\"auto\"/></colgroup><tbody><tr height=\"34px\"><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">参数顺序</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">字段名</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">说明</div></td></tr><tr height=\"34px\"><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">0</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">values</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">当前行的values</div></td></tr><tr height=\"34px\"><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">1</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">ctx</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">当前行的formCore</div></td></tr><tr height=\"34px\"><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">2</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">index</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">当前行的序号</div></td></tr><tr height=\"34px\"><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">3</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">keys</div></td><td rowspan=\"1\" colSpan=\"1\"><div data-type=\"p\">当前行的values的属性名</div></td></tr></tbody></table></div><div data-type=\"p\"></div><h1 id=\"2dmzng\" data-type=\"h\"><a class=\"anchor\" id=\"返回\" href=\"#2dmzng\"></a>返回</h1><h3 id=\"fm08ti\" data-type=\"h\"><a class=\"anchor\" id=\"1.-简单返回-boolean\" href=\"#fm08ti\"></a>1. 简单返回 Boolean</h3><div data-type=\"p\"><code>true</code> 代表成功， <code>false</code> 表示失败。失败会阻止此次操作</div><div data-type=\"p\"></div><pre data-syntax=\"jsx\"><code class=\"language-jsx\">add: async () =&gt; {\n    return true;\n}\n</code></pre><div data-type=\"p\"></div><h3 id=\"fn3nav\" data-type=\"h\"><a class=\"anchor\" id=\"2.-返回object\" href=\"#fn3nav\"></a>2. 返回Object</h3><div data-type=\"p\"></div><blockquote><div data-type=\"p\">注意：返回object不能混用 <code>values</code> 和 <code>item</code>, 只能使用其中的一个。</div></blockquote><div data-type=\"p\"></div><h3 id=\"oaokgg\" data-type=\"h\"><a class=\"anchor\" id=\"-1.-返回values（批量替换）\" href=\"#oaokgg\"></a>#1. 返回values（批量替换）</h3><pre data-syntax=\"jsx\"><code class=\"language-jsx\">add: async () =&gt; {\n    return {\n        success: true,\n        values: []\n    }\n}\n</code></pre><div data-type=\"p\"></div><h3 id=\"fge3cg\" data-type=\"h\"><a class=\"anchor\" id=\"-2.-返回item（替换当前项）\" href=\"#fge3cg\"></a>#2. 返回item（替换当前项）</h3><pre data-syntax=\"jsx\"><code class=\"language-jsx\">add: async () =&gt; {    \n    return {\n        success: true,\n        item: singleItem\n    }\n}\n</code></pre><div data-type=\"p\"></div><h3 id=\"it8gum\" data-type=\"h\"><a class=\"anchor\" id=\"-3.-单纯返回success\" href=\"#it8gum\"></a>#3. 单纯返回success</h3><div data-type=\"p\">效果和简单返回success一致。</div><pre data-syntax=\"jsx\"><code class=\"language-jsx\">add: async () =&gt; {\n    return {\n        success: false\n    }\n}\n</code></pre><div data-type=\"p\"></div>","public":1,"status":null,"likes_count":0,"comments_count":0,"content_updated_at":"2018-12-10T10:15:43.000Z","deleted_at":null,"created_at":"2018-12-10T10:03:37.000Z","updated_at":"2018-12-11T00:42:43.000Z","published_at":"2018-12-10T10:15:43.000Z","first_published_at":null,"word_count":243,"cover":null,"description":"钩子与拦截函数查看DEMO可以直接看到更详细的配置，请参考Repeater 钩子该配置函数能够控制 Repeter的以下操作： add, update, save, remove通用格式如下：const asyncHandler = {     add: () =&gt; {},     up...","custom_description":null,"_serializer":"v2.doc_detail"}